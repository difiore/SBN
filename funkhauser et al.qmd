---
title: "Funkhauser et al"
format:
  html:
    embed-resources: true
    code-overflow: wrap
    code-block-bg: true
    code-block-border-left: "#31BAE9"
    code-summary: "Code hint"
editor_options: 
  chunk_output_type: console
---

```{r}
library(tidyverse)
library(igraph)
library(visNetwork)
d <- read_csv("data/funkhauser_et_al-S1Table.csv", col_names = TRUE)
d <- select(d, c(-1))
d <- as.matrix(d)
e <- d + t(d)
e <- e/2
mean(e)
gd <- graph_from_adjacency_matrix(d, mode = "directed", weighted = TRUE)
gd
gu <- graph_from_adjacency_matrix(e, mode = "undirected", weighted = TRUE)

gd_vis <- toVisNetworkData(gd, idToLabel = TRUE)

edges <- data.frame(gd_vis$edges)
nodes <- data.frame(gd_vis$nodes)
edges$value <- edges$weight

visNetwork(edges = edges, nodes = nodes) %>%
  visEdges(arrows = "to", smooth = FALSE)

visIgraph(gd) %>%
  visEdges(width = "weight") 

visIgraph(gu)
c <- cluster_fast_greedy(gu)
modularity(c)
modularity(gu, membership(c))
strength(gu, mode = "all")
eigen_centrality(gu)$vector
eigen_centrality(gd)$vector
reach <- (ego_size(gu, 3) - 1)/(vcount(gu) - 1)
cluster_coef <- transitivity(gd, "local")
plot_dendrogram(c)
```
